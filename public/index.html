<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Everspeak - Talk to Your Loved Ones</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <!-- "First Conversation Reminder" Banner -->
  <div class="first-conversation-banner" id="first-conversation-banner" style="display: none;" data-testid="banner-first-conversation">
    <p>When you're ready, you can begin your first conversation here.</p>
    <button class="btn-begin-conversation" id="btn-begin-conversation-banner" data-testid="button-begin-conversation-banner">Begin Conversation</button>
    <button class="btn-close-conversation-banner" id="btn-close-conversation-banner" data-testid="button-close-conversation-banner">Ã—</button>
  </div>

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar" data-testid="sidebar">
    <div class="sidebar-header">
      <h3>Settings</h3>
      <button class="sidebar-close" id="sidebar-close" data-testid="button-sidebar-close">&times;</button>
    </div>
    
    <div class="sidebar-content">
      <!-- Persona Setup Section -->
      <div class="sidebar-section">
        <h4>Persona Setup</h4>
        <div class="sidebar-section-content">
          <div class="persona-status" id="sidebar-persona-status">
            <p class="status-label">Current persona:</p>
            <p class="status-value" id="sidebar-persona-name">None selected</p>
            <p class="status-completion" id="sidebar-persona-completion">Setup not started</p>
          </div>
          <button class="btn-sidebar-action" id="sidebar-restart-wizard" data-testid="button-sidebar-restart-wizard">
            Restart Wizard
          </button>
        </div>
      </div>
      
      <!-- More sections will go here -->
    </div>
  </div>
  
  <!-- Sidebar Overlay (click to close) -->
  <div class="sidebar-overlay" id="sidebar-overlay" data-testid="sidebar-overlay"></div>

  <div class="container">
    <!-- Top Bar with Hamburger -->
    <div class="top-bar">
      <button class="hamburger-menu" id="hamburger-menu" data-testid="button-hamburger-menu" aria-label="Open menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <header>
      <h1>Everspeak</h1>
      <p>Keep the conversation going with those you love</p>
    </header>

    <!-- Grounding Banner -->
    <div class="grounding-banner" id="grounding-banner" data-testid="grounding-banner">
      <p>
        EverSpeak is a memory-based companion. It's not the real person, not a ghost, and not a therapist. 
        It's here to help you reflect using your own memories.
      </p>
      <button class="banner-dismiss" id="banner-dismiss" data-testid="button-dismiss-banner">Got it</button>
    </div>

    <main class="panels">
      <!-- Persona Panel -->
      <section class="panel persona-panel">
        <h2>Persona</h2>
        
        <div class="persona-selector">
          <label for="persona-dropdown">Select Persona:</label>
          <select id="persona-dropdown" data-testid="select-persona">
            <option value="">-- Choose a persona --</option>
          </select>
        </div>

        <div class="continue-setup-container" id="continue-setup-container" style="display: none;">
          <button class="btn-continue-setup" id="continue-setup-btn" data-testid="button-continue-setup">
            Continue Setup
          </button>
          <p class="setup-hint">Complete the wizard to start your first conversation</p>
        </div>

        <div class="persona-info" id="persona-info">
          <p class="info-item"><strong>Name:</strong> <span id="info-name" data-testid="text-persona-name">-</span></p>
          <p class="info-item"><strong>Relationship:</strong> <span id="info-relationship" data-testid="text-persona-relationship">-</span></p>
          <p class="info-item"><strong>Description:</strong> <span id="info-description" data-testid="text-persona-description">-</span></p>
        </div>

        <div class="wizard-section" id="wizard-section" style="display: none;">
          <button class="btn-setup-wizard" id="setup-wizard-btn" data-testid="button-setup-wizard">Setup Wizard</button>
          <p class="wizard-hint">Use the wizard to quickly set up this persona with AI-guided questions</p>
        </div>

        <div class="settings-section" id="settings-section" style="display: none;">
          <h3>Persona Settings</h3>
          <p class="settings-description">Calibrate communication style and boundaries</p>
          
          <div class="form-group">
            <label for="tone-mode-select">Default Tone Mode</label>
            <select id="tone-mode-select" class="settings-select" data-testid="select-tone-mode">
              <option value="auto">Auto</option>
              <option value="comforting">Comforting</option>
              <option value="honest">Honest</option>
              <option value="playful">Playful</option>
              <option value="balanced">Balanced</option>
            </select>
          </div>

          <div class="slider-group">
            <label for="humor-slider">Humor <span id="humor-value" class="slider-value">3</span></label>
            <input type="range" id="humor-slider" min="0" max="5" step="0.5" value="3" class="calibration-slider" data-testid="slider-humor">
          </div>

          <div class="slider-group">
            <label for="honesty-slider">Honesty <span id="honesty-value" class="slider-value">3</span></label>
            <input type="range" id="honesty-slider" min="0" max="5" step="0.5" value="3" class="calibration-slider" data-testid="slider-honesty">
          </div>

          <div class="slider-group">
            <label for="sentimentality-slider">Sentimentality <span id="sentimentality-value" class="slider-value">3</span></label>
            <input type="range" id="sentimentality-slider" min="0" max="5" step="0.5" value="3" class="calibration-slider" data-testid="slider-sentimentality">
          </div>

          <div class="slider-group">
            <label for="energy-slider">Energy <span id="energy-value" class="slider-value">3</span></label>
            <input type="range" id="energy-slider" min="0" max="5" step="0.5" value="3" class="calibration-slider" data-testid="slider-energy">
          </div>

          <div class="slider-group">
            <label for="advice-slider">Advice-giving <span id="advice-value" class="slider-value">2</span></label>
            <input type="range" id="advice-slider" min="0" max="5" step="0.5" value="2" class="calibration-slider" data-testid="slider-advice">
          </div>

          <div class="boundaries-group">
            <label class="boundary-label">Boundaries</label>
            <div class="checkbox-item">
              <input type="checkbox" id="avoid-regret-spirals" checked data-testid="checkbox-avoid-regret">
              <label for="avoid-regret-spirals">Avoid regret spirals</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="no-paranormal-language" checked data-testid="checkbox-no-paranormal">
              <label for="no-paranormal-language">No paranormal language</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="soften-sensitive-topics" checked data-testid="checkbox-soften-sensitive">
              <label for="soften-sensitive-topics">Soften sensitive topics</label>
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="prefer-reassurance" checked data-testid="checkbox-prefer-reassurance">
              <label for="prefer-reassurance">Prefer reassurance</label>
            </div>
          </div>

          <button class="btn-save-settings" id="save-settings-btn" data-testid="button-save-settings">Save Settings</button>
          <div class="settings-feedback" id="settings-feedback" style="display: none;"></div>
          
          <div class="boost-section">
            <button class="btn-boost-persona" id="boost-persona-btn" data-testid="button-boost-persona">âœ¨ Improve Persona Accuracy</button>
            <p class="boost-hint">Get AI-powered recommendations to enhance this persona</p>
          </div>
        </div>

        <div class="snapshots-section" id="snapshots-section" style="display: none;">
          <h3>Snapshots</h3>
          <p class="snapshots-description">Save versions of this persona to restore later</p>
          <button class="btn-create-snapshot" id="create-snapshot-btn" data-testid="button-create-snapshot">Create Snapshot</button>
          <div id="snapshots-list" data-testid="list-snapshots">
            <p class="placeholder">No snapshots yet</p>
          </div>
        </div>

        <div class="create-persona-form">
          <h3>Create New Persona</h3>
          <form id="persona-form">
            <div class="form-group">
              <label for="persona-name">Name *</label>
              <input type="text" id="persona-name" data-testid="input-persona-name" required>
            </div>
            <div class="form-group">
              <label for="persona-relationship">Relationship</label>
              <input type="text" id="persona-relationship" data-testid="input-persona-relationship" placeholder="e.g., Brother, Mother, Friend">
            </div>
            <div class="form-group">
              <label for="persona-description">Description</label>
              <textarea id="persona-description" data-testid="input-persona-description" rows="3" placeholder="Tell us about this person..."></textarea>
            </div>
            <button type="submit" data-testid="button-save-persona">Save Persona</button>
          </form>
        </div>
      </section>

      <!-- Memory Panel -->
      <section class="panel memory-panel">
        <div class="panel-header">
          <h2>Memories</h2>
          <button id="bulk-import-btn" data-testid="button-bulk-import" class="btn-secondary" style="display: none;">Bulk Import</button>
        </div>
        
        <div id="memories-list" data-testid="list-memories">
          <p class="placeholder">Select a persona to view memories</p>
        </div>

        <div class="memory-hint" id="memory-hint" style="display: none;">
          <p><strong>ðŸ’¡ Helpful tip:</strong> Anytime a memory pops into your mind, you can add it here. Every memory you share helps our conversations feel more like them.</p>
        </div>

        <div class="add-memory-form">
          <h3>Add Memory</h3>
          <form id="memory-form">
            <div class="form-group">
              <label for="memory-category">Category *</label>
              <select id="memory-category" data-testid="select-memory-category" required>
                <option value="">-- Choose category --</option>
                <option value="humor">Humor</option>
                <option value="regrets">Regrets</option>
                <option value="childhood">Childhood</option>
                <option value="advice">Advice</option>
                <option value="personality">Personality</option>
                <option value="misc">Misc</option>
              </select>
            </div>
            <div class="form-group">
              <label for="memory-text">Memory *</label>
              <div class="memory-text-wrapper">
                <textarea id="memory-text" data-testid="input-memory-text" rows="3" required placeholder="Describe this memory..."></textarea>
                <button type="button" id="voice-record-btn" data-testid="button-voice-record" class="voice-btn" title="Record voice">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
                    <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                    <line x1="12" y1="19" x2="12" y2="22"></line>
                  </svg>
                </button>
              </div>
              <div class="voice-status" id="voice-status" style="display: none;"></div>
            </div>
            <div class="form-group">
              <label for="memory-weight">Weight (0.1 - 5.0)</label>
              <input type="number" id="memory-weight" data-testid="input-memory-weight" min="0.1" max="5.0" step="0.1" value="1.0">
            </div>
            <button type="submit" data-testid="button-add-memory">Add Memory</button>
          </form>
        </div>
      </section>

      <!-- Journal Panel -->
      <section class="panel journal-panel">
        <h2>Journal</h2>
        
        <div id="journal-entries-list" data-testid="list-journal-entries">
          <p class="placeholder">No journal entries yet</p>
        </div>

        <div class="add-journal-form">
          <h3>New Journal Entry</h3>
          <form id="journal-form">
            <div class="form-group">
              <label for="journal-text">Entry *</label>
              <textarea id="journal-text" data-testid="input-journal-text" rows="4" required placeholder="What's on your mind?"></textarea>
            </div>
            <div class="form-group">
              <label for="journal-mood">Mood (optional)</label>
              <select id="journal-mood" data-testid="select-journal-mood">
                <option value="">-- Select mood --</option>
                <option value="calm">Calm</option>
                <option value="sad">Sad</option>
                <option value="reflective">Reflective</option>
                <option value="angry">Angry</option>
                <option value="hopeful">Hopeful</option>
                <option value="grateful">Grateful</option>
                <option value="anxious">Anxious</option>
                <option value="peaceful">Peaceful</option>
              </select>
            </div>
            <div class="form-group">
              <label for="journal-persona">Link to Persona (optional)</label>
              <select id="journal-persona" data-testid="select-journal-persona">
                <option value="">-- None --</option>
              </select>
            </div>
            <div class="form-group">
              <label for="journal-tags">Tags (optional, comma-separated)</label>
              <input type="text" id="journal-tags" data-testid="input-journal-tags" placeholder="e.g., grief, memory, reflection">
            </div>
            <div class="checkbox-item">
              <input type="checkbox" id="generate-reflection" data-testid="checkbox-generate-reflection">
              <label for="generate-reflection">Generate AI reflection</label>
            </div>
            <button type="submit" data-testid="button-save-journal">Save Journal Entry</button>
          </form>
        </div>
      </section>

      <!-- Conversation Room -->
      <section class="panel conversation-room" id="conversation-room">
        <!-- Room Header -->
        <div class="room-header">
          <div class="room-header-left">
            <div class="persona-avatar" id="persona-avatar" data-testid="persona-avatar">
              <span id="avatar-initials" data-testid="avatar-initials">?</span>
            </div>
            <div class="room-title-area">
              <h2 class="room-title" id="room-title" data-testid="room-title">Connection</h2>
              <p class="room-subtitle" id="room-subtitle" data-testid="room-subtitle">Select someone to begin a conversation.</p>
            </div>
          </div>
          <div class="room-header-right">
            <div class="room-controls">
              <!-- Text Size Control -->
              <div class="text-size-control">
                <span class="control-label">Text size:</span>
                <div class="segmented-control">
                  <button class="segment-btn active" id="text-size-normal" data-testid="button-text-size-normal">Normal</button>
                  <button class="segment-btn" id="text-size-large" data-testid="button-text-size-large">Large</button>
                </div>
              </div>
              <!-- Voice Control (UI only) -->
              <div class="voice-control">
                <label class="toggle-label">
                  <input type="checkbox" id="voice-toggle" data-testid="checkbox-voice-toggle">
                  <span class="toggle-slider"></span>
                  <span class="toggle-text">Voice responses (preview)</span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Messages Container -->
        <div class="messages-container">
          <div class="chat-messages" id="chat-messages" data-testid="chat-messages">
            <!-- Empty state will be injected here -->
            <div class="empty-state" id="empty-state" data-testid="empty-state">
              <p>To begin, create or select someone you'd like to talk to.</p>
            </div>
          </div>

          <!-- Healthy Use Nudge -->
          <div class="healthy-use-nudge" id="healthy-use-nudge" data-testid="healthy-use-nudge" style="display: none;">
            <p>
              You've been talking for a while. It might help to take a short break, stretch, or write down how you're feeling. 
              I'll be here when you come back.
            </p>
          </div>

          <!-- Strict Mode Indicator -->
          <div class="strict-mode-indicator" id="strict-mode-indicator" data-testid="strict-mode-indicator" style="display: none;">
            <span class="strict-mode-text">Strict mode: staying closer to their real personality.</span>
            <a href="#" id="strict-mode-turn-off" data-testid="link-strict-mode-turn-off">Turn off</a>
          </div>
        </div>

        <!-- Room Footer -->
        <div class="room-footer">
          <form id="chat-form">
            <!-- Optional Controls -->
            <div class="optional-controls">
              <div class="optional-control-item">
                <label for="emotional-state">Optional: mood</label>
                <select id="emotional-state" data-testid="select-emotional-state">
                  <option value="neutral">Neutral</option>
                  <option value="sad">Sad</option>
                  <option value="reflective">Reflective</option>
                  <option value="anxious">Anxious</option>
                  <option value="excited">Excited</option>
                  <option value="nostalgic">Nostalgic</option>
                </select>
              </div>
              <div class="optional-control-item">
                <label for="tone-mode">Optional: tone</label>
                <select id="tone-mode" data-testid="select-chat-tone-mode">
                  <option value="auto">Auto</option>
                  <option value="comforting">Comforting</option>
                  <option value="honest">Honest</option>
                  <option value="playful">Playful</option>
                  <option value="balanced">Balanced</option>
                </select>
              </div>
            </div>
            <!-- Main Input -->
            <div class="main-input-area">
              <textarea id="chat-input" data-testid="input-chat-message" rows="2" placeholder="Type your message..." required></textarea>
              <button type="submit" class="send-btn" data-testid="button-send-message">Send</button>
            </div>
          </form>
        </div>
      </section>
    </main>
  </div>

  <!-- Bulk Import Modal -->
  <div id="bulk-import-modal" class="modal" style="display: none;" data-testid="modal-bulk-import">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Bulk Import Memories</h2>
        <button class="modal-close" id="close-bulk-import" data-testid="button-close-bulk-import">&times;</button>
      </div>
      <div class="modal-body">
        <p class="modal-description">Paste multiple memories below (one per line, or separated by periods or semicolons). AI will automatically categorize and weight each memory.</p>
        <form id="bulk-import-form">
          <div class="form-group">
            <label for="bulk-text">Memories</label>
            <textarea id="bulk-text" data-testid="input-bulk-text" rows="10" required placeholder="He loved fishing at the lake. Always told dad jokes. Gave great advice about work..."></textarea>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="auto-weight-checkbox" data-testid="checkbox-auto-weight" checked>
            <label for="auto-weight-checkbox">Auto-assign categories & weights using AI</label>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn-secondary" id="cancel-bulk-import" data-testid="button-cancel-bulk-import">Cancel</button>
            <button type="submit" data-testid="button-import-memories">Import Memories</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Setup Wizard Modal -->
  <div id="wizard-modal" class="modal wizard-modal" style="display: none;" data-testid="modal-wizard">
    <div class="modal-content wizard-content">
      <div class="modal-header">
        <h2>Setup Wizard</h2>
        <button class="modal-close" id="close-wizard" data-testid="button-close-wizard">&times;</button>
      </div>
      
      <!-- Progress Indicator -->
      <div class="wizard-progress">
        <div class="progress-bar">
          <div class="progress-fill" id="wizard-progress-fill"></div>
        </div>
        <p class="progress-text">Getting to know themâ€¦ Step <span id="wizard-current-step">1</span> of <span id="wizard-total-steps">11</span></p>
      </div>

      <div class="modal-body">
        <form id="wizard-form">
          <!-- Step 1: Welcome / Step Zero -->
          <div class="wizard-step" id="wizard-step-1" data-step="1">
            <h3>Welcome to EverSpeak.</h3>
            <p class="step-intro">Before we begin, I want to gently explain what this space is for.</p>
            <p class="step-description">EverSpeak was created to help you reconnect with the memory, personality, and presence of someone you've lost â€” not by replacing them, but by honoring the stories and love you shared.</p>
            <p class="step-description">To do that, I'll ask you a few thoughtful questions. Each one helps me understand your loved one more fully â€” their personality, their humor, and the role they played in your life.</p>
            <p class="step-description">You are always in control. You can skip anything that feels too hard, and you can stop at any time. This isn't a test. It's a conversation we'll take at your pace.</p>
          </div>

          <!-- Step 2: Personality -->
          <div class="wizard-step" id="wizard-step-2" data-step="2" style="display: none;">
            <p class="step-acknowledgment"></p>
            <h3>Getting to Know Who They Were</h3>
            <p class="step-intro">Before we go any further, I want to acknowledge something important: you're here because you lost someone who mattered deeply to you. That takes courage. We'll go through this slowly and gently.</p>
            <p class="step-description">When you think about who they were as a person, how would you describe their personality?</p>
            <textarea id="wizard-personality" data-testid="input-wizard-personality" rows="4" placeholder="Were they gentle, intense, steady, silly, serious, nurturing, reservedâ€¦? Anything that feels true."></textarea>
          </div>

          <!-- Step 3: Communication Style -->
          <div class="wizard-step" id="wizard-step-3" data-step="3" style="display: none;">
            <p class="step-acknowledgment"></p>
            <h3>How It Felt to Talk With Them</h3>
            <p class="step-description">When you talked with them, what did it feel like?</p>
            <textarea id="wizard-communication-style" data-testid="input-wizard-communication-style" rows="4" placeholder="Did they listen quietly? Tease you? Get straight to the point? Wrap you in warmth? Something else?"></textarea>
          </div>

          <!-- Step 4: Humor -->
          <div class="wizard-step" id="wizard-step-4" data-step="4" style="display: none;">
            <p class="step-acknowledgment"></p>
            <h3>Their Humor (If Any)</h3>
            <p class="step-description">Did they have a sense of humor? If so, what was it like?</p>
            <textarea id="wizard-humor" data-testid="input-wizard-humor" rows="4" placeholder="Dry, goofy, sarcastic, gentle, punny, dark, playfulâ€¦ or you can say they weren't really the joking type."></textarea>
          </div>

          <!-- Step 5: When They Passed -->
          <div class="wizard-step" id="wizard-step-5" data-step="5" style="display: none;">
            <p class="step-acknowledgment"></p>
            <h3>When You Lost Them</h3>
            <p class="step-description">When did you lose them? It's okay if you only remember the general time.</p>
            <input type="text" id="wizard-date-passed" data-testid="input-wizard-date-passed" placeholder="For example: 'Spring 2023', 'about two years ago', or 'November 15, 2021'.">
          </div>

          <!-- Step 6: Relationship Dynamics -->
          <div class="wizard-step" id="wizard-step-6" data-step="6" style="display: none;">
            <p class="step-acknowledgment"></p>
            <h3>How Things Were Near the End</h3>
            <p class="step-description">How were things between you near the end? There's no right or wrong answer.</p>
            <textarea id="wizard-relationship-end" data-testid="input-wizard-relationship-end" rows="4" placeholder="Were you close? Was it complicated? Was it sudden, or a long illness? Were there things that never got said?"></textarea>
          </div>

          <!-- Step 7: Circumstances (Optional) -->
          <div class="wizard-step" id="wizard-step-7" data-step="7" style="display: none;">
            <p class="step-acknowledgment"></p>
            <h3>If You're Comfortable Sharingâ€¦</h3>
            <p class="step-description">If you feel okay sharing, how did they pass? This is completely optional â€” you can skip it if it feels too heavy right now.</p>
            <textarea id="wizard-circumstances" data-testid="input-wizard-circumstances" rows="4" placeholder="You can share as much or as little as you'd like. It's also okay to leave this blank."></textarea>
            <button type="button" class="btn-skip-step" id="skip-circumstances" data-testid="button-skip-circumstances">I'm not ready to talk about this yet</button>
          </div>

          <!-- Step 8: Memories -->
          <div class="wizard-step" id="wizard-step-8" data-step="8" style="display: none;">
            <p class="step-acknowledgment"></p>
            <h3>Memories That Stay With You</h3>
            <p class="step-description">Tell me about a few moments you think of often. They don't need to be big or dramatic â€” just real.</p>
            <textarea id="wizard-memories" data-testid="input-wizard-memories" rows="5" placeholder="Everyday routines, little rituals, big days, private jokesâ€¦ anything that still feels vivid."></textarea>
          </div>

          <!-- Step 9: Conversations -->
          <div class="wizard-step" id="wizard-step-9" data-step="9" style="display: none;">
            <p class="step-acknowledgment"></p>
            <h3>Things Left Unsaid</h3>
            <p class="step-description">Is there anything you wish you could have said to them, or heard from them?</p>
            <textarea id="wizard-conversations" data-testid="input-wizard-conversations" rows="4" placeholder="Regrets, apologies, reassurances, questions â€” anything you still find yourself carrying."></textarea>
          </div>

          <!-- Step 10: Tone Preferences -->
          <div class="wizard-step" id="wizard-step-10" data-step="10" style="display: none;">
            <p class="step-acknowledgment"></p>
            <h3>How You'd Like Them to Sound Here</h3>
            <p class="step-description">Now we'll set how you'd like them to show up in these conversations. There are no perfect settings â€” just choose what feels most supportive for you right now.</p>
            
            <div class="slider-group">
              <label for="wizard-humor-level">Humor <span id="wizard-humor-value" class="slider-value">3</span></label>
              <p class="slider-helper">How much lightness or playfulness feels okay for you?</p>
              <input type="range" id="wizard-humor-level" data-testid="slider-wizard-humor" min="0" max="5" step="0.5" value="3" class="calibration-slider">
            </div>

            <div class="slider-group">
              <label for="wizard-honesty-level">Honesty <span id="wizard-honesty-value" class="slider-value">3</span></label>
              <p class="slider-helper">Do you want them to be very gentle, or more direct?</p>
              <input type="range" id="wizard-honesty-level" data-testid="slider-wizard-honesty" min="0" max="5" step="0.5" value="3" class="calibration-slider">
            </div>

            <div class="slider-group">
              <label for="wizard-sentimentality-level">Sentimentality <span id="wizard-sentimentality-value" class="slider-value">3</span></label>
              <p class="slider-helper">How emotional or tender do you want the tone to be?</p>
              <input type="range" id="wizard-sentimentality-level" data-testid="slider-wizard-sentimentality" min="0" max="5" step="0.5" value="3" class="calibration-slider">
            </div>

            <div class="slider-group">
              <label for="wizard-energy-level">Energy <span id="wizard-energy-value" class="slider-value">3</span></label>
              <p class="slider-helper">Do you prefer a calm, steady presence or more enthusiasm?</p>
              <input type="range" id="wizard-energy-level" data-testid="slider-wizard-energy" min="0" max="5" step="0.5" value="3" class="calibration-slider">
            </div>

            <div class="slider-group">
              <label for="wizard-advice-level">Advice-giving <span id="wizard-advice-value" class="slider-value">2</span></label>
              <p class="slider-helper">Do you want a lot of advice, or mostly listening and reflecting?</p>
              <input type="range" id="wizard-advice-level" data-testid="slider-wizard-advice" min="0" max="5" step="0.5" value="2" class="calibration-slider">
            </div>
          </div>

          <!-- Step 11: Transition Screen -->
          <div class="wizard-step" id="wizard-step-11" data-step="11" style="display: none;">
            <div class="transition-content">
              <h3>Thank You for Sharing All of That</h3>
              <p class="step-description">I know none of this is easy to talk about. Everything you've shared will be held carefully and used to shape how they 'sound' here â€” drawn only from your memories, never pretending to be more than that.</p>
              
              <div class="transition-info">
                <p><strong>We'll use this to:</strong></p>
                <ul>
                  <li>shape a gentle first message in their voice,</li>
                  <li>honor the way you described their personality and presence,</li>
                  <li>respect the boundaries and tone that feel safest for you right now.</li>
                </ul>
              </div>
              
              <p class="transition-question">Would you like to begin your first conversation now, or take a moment before we continue?</p>
              
              <div class="wizard-loading" id="wizard-loading" style="display: none;">
                <p>Preparing your conversation... This may take a moment.</p>
                <div class="loading-spinner"></div>
              </div>
            </div>
          </div>

          <!-- Navigation Buttons -->
          <div class="wizard-navigation">
            <button type="button" class="btn-secondary" id="wizard-prev" data-testid="button-wizard-prev" style="display: none;">Previous</button>
            <div class="nav-spacer"></div>
            <button type="button" id="wizard-next" data-testid="button-wizard-next">Next</button>
            <button type="submit" id="wizard-begin-conversation" data-testid="button-wizard-begin-conversation" style="display: none;">Begin our first conversation</button>
            <button type="button" class="btn-secondary" id="wizard-give-moment" data-testid="button-wizard-give-moment" style="display: none;">Give me a moment</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Boost Modal -->
  <div id="boost-modal" class="modal boost-modal" style="display: none;" data-testid="modal-boost">
    <div class="modal-content boost-content">
      <div class="modal-header">
        <h2>Persona Accuracy Recommendations</h2>
        <button class="modal-close" id="close-boost" data-testid="button-close-boost">&times;</button>
      </div>
      
      <div class="modal-body">
        <div id="boost-loading" class="boost-loading">
          <p>Analyzing persona... This may take a moment.</p>
          <div class="loading-spinner"></div>
        </div>
        
        <div id="boost-results" style="display: none;">
          <!-- Missing Categories -->
          <div class="boost-section">
            <h3>Missing Categories</h3>
            <div id="missing-categories-list"></div>
          </div>

          <!-- Suggested Memories -->
          <div class="boost-section">
            <h3>Suggested Memories</h3>
            <div id="suggested-memories-list"></div>
          </div>

          <!-- Tone Suggestions -->
          <div class="boost-section">
            <h3>Tone Calibration Suggestions</h3>
            <div id="tone-suggestions-container"></div>
            <button class="btn-apply-tone" id="apply-tone-btn" data-testid="button-apply-tone" style="display: none;">Apply Tone Suggestions</button>
          </div>

          <!-- Boundary Flags -->
          <div class="boost-section">
            <h3>Boundary Flags</h3>
            <div id="boundary-flags-list"></div>
          </div>

          <div class="boost-actions">
            <button class="btn-secondary" id="refresh-boost-btn" data-testid="button-refresh-boost">Refresh Recommendations</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
