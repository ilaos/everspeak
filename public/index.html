<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Everspeak - Talk to Your Loved Ones</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css?v=20241229-2">
</head>
<body>
  <!-- "First Conversation Reminder" Banner -->
  <div class="first-conversation-banner" id="first-conversation-banner" style="display: none;" data-testid="banner-first-conversation">
    <p>When you're ready, you can begin your first conversation here.</p>
    <button class="btn-begin-conversation" id="btn-begin-conversation-banner" data-testid="button-begin-conversation-banner">Begin Conversation</button>
    <button class="btn-close-conversation-banner" id="btn-close-conversation-banner" data-testid="button-close-conversation-banner">√ó</button>
  </div>

  <!-- Sidebar Navigation -->
  <div class="sidebar" id="sidebar" data-testid="sidebar">
    <div class="sidebar-header">
      <h3>Menu</h3>
      <button class="sidebar-close" id="sidebar-close" data-testid="button-sidebar-close">&times;</button>
    </div>
    
    <div class="sidebar-content">
      <nav class="sidebar-nav">
        <button class="nav-link active" data-page="home" data-testid="nav-home">
          <span>Home</span>
        </button>
        <button class="nav-link" data-page="conversation" data-testid="nav-conversation">
          <span>The Conversation Room</span>
        </button>
        <button class="nav-link" data-page="journal" data-testid="nav-journal">
          <span>Journal</span>
        </button>
        <button class="nav-link" data-page="memories" data-testid="nav-memories">
          <span>Memories</span>
        </button>
        <button class="nav-link" data-page="personas" data-testid="nav-personas">
          <span>Personas</span>
        </button>
        <button class="nav-link" data-page="settings" data-testid="nav-settings">
          <span>Settings</span>
        </button>
      </nav>
    </div>
  </div>
  
  <!-- Sidebar Overlay (click to close) -->
  <div class="sidebar-overlay" id="sidebar-overlay" data-testid="sidebar-overlay"></div>

  <div class="container">
    <!-- Top Bar with Hamburger -->
    <div class="top-bar">
      <button class="hamburger-menu" id="hamburger-menu" data-testid="button-hamburger-menu" aria-label="Open menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <header>
      <img src="/attached_assets/everspeak_logo_1763441815675.png" alt="Everspeak" class="header-logo" data-testid="img-logo">
      <p class="header-tagline">Honor. Reflect. Heal.</p>
    </header>

    <main class="panels">
      <!-- Home Page -->
      <section class="page-view" id="page-home" data-page="home" style="display: block;">
        <div class="home-welcome">
          <h1 class="home-title">Welcome to EverSpeak</h1>
          <p class="home-subtitle">Honor. Reflect. Heal.</p>
          <p class="home-description">
            EverSpeak helps you reconnect with the memory and presence of someone you've lost.
            Through thoughtful questions, we create a space where you can share stories,
            preserve memories, and keep their spirit alive.
          </p>

          <div class="home-actions">
            <button class="btn-home-primary" id="btn-home-setup-wizard" data-testid="button-home-setup-wizard">
              <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14M5 12h14"/>
              </svg>
              Create Your First Persona
            </button>

            <p class="home-helper-text">Already have a persona? Select it from the <strong>Personas</strong> tab below.</p>
          </div>
        </div>
      </section>

      <!-- Conversation Room / Speak Now Page -->
      <section class="conversation-room" id="page-conversation" data-page="conversation" style="display: none;">
        <!-- Animated fog layer 3 -->
        <div class="fog-layer-3"></div>
        
        <!-- Room Header Text -->
        <div class="room-welcome">
          <h1>Welcome to Your Conversation Room</h1>
          <p class="room-subtitle">This is a safe space to honor <span id="persona-name-display">[Name]</span>, process your thoughts, and hold onto what matters.</p>
          <p class="room-instruction">Begin when it feels right</p>
        </div>

        <!-- Chat Messages Area -->
        <div class="chat-messages" id="chat-messages" data-testid="chat-messages">
          <!-- Messages will appear here -->
        </div>

        <!-- Chat Input Area -->
        <div class="chat-input-container">
          <form id="chat-form" data-testid="form-chat">
            <input 
              type="text" 
              id="chat-input" 
              data-testid="input-chat-message"
              placeholder="Type your message here..."
              autocomplete="off"
            />
            <button type="submit" data-testid="button-send-message">Send</button>
          </form>
        </div>
      </section>

      <!-- Journal Page -->
      <section class="page-view" id="page-journal" data-page="journal" style="display: none;">
        <div class="page-header">
          <h2>Journal</h2>
          <p class="page-description">Your private reflection space for processing emotions and memories ‚Äî separate from conversations with personas.</p>
        </div>
        <div class="page-content">
          <div class="feature-explanation">
            <p><strong>How it works:</strong></p>
            <ul>
              <li>Write your thoughts and feelings for yourself (not talking to the persona)</li>
              <li>Optionally request an AI-generated gentle reflection on your entry</li>
              <li>Link entries to personas for personalized context in reflections</li>
              <li>Track moods and organize by tags to see your journey over time</li>
            </ul>
          </div>
          
          <div id="journal-entries-list" data-testid="list-journal-entries">
            <p class="placeholder">No journal entries yet</p>
          </div>

          <div class="add-journal-form">
            <h3>New Journal Entry</h3>
            <form id="journal-form">
              <div class="form-group">
                <label for="journal-text">Entry *</label>
                <textarea id="journal-text" data-testid="input-journal-text" rows="4" required placeholder="What's on your mind?"></textarea>
              </div>
              <div class="form-group">
                <label for="journal-mood">Mood (optional)</label>
                <select id="journal-mood" data-testid="select-journal-mood">
                  <option value="">-- Select mood --</option>
                  <option value="calm">Calm</option>
                  <option value="sad">Sad</option>
                  <option value="reflective">Reflective</option>
                  <option value="angry">Angry</option>
                  <option value="hopeful">Hopeful</option>
                  <option value="grateful">Grateful</option>
                  <option value="anxious">Anxious</option>
                  <option value="peaceful">Peaceful</option>
                </select>
              </div>
              <div class="form-group">
                <label for="journal-persona">Link to Persona (optional)</label>
                <select id="journal-persona" data-testid="select-journal-persona">
                  <option value="">-- None --</option>
                </select>
              </div>
              <div class="form-group">
                <label for="journal-tags">Tags (optional, comma-separated)</label>
                <input type="text" id="journal-tags" data-testid="input-journal-tags" placeholder="e.g., grief, memory, reflection">
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="generate-reflection" data-testid="checkbox-generate-reflection">
                <label for="generate-reflection">Generate AI reflection</label>
              </div>
              <button type="submit" data-testid="button-save-journal">Save Journal Entry</button>
            </form>
          </div>
        </div>
      </section>

      <!-- Memories Page -->
      <section class="page-view" id="page-memories" data-page="memories" style="display: none;">
        <div class="page-header">
          <div class="page-header-title">
            <h2>Memories</h2>
            <p class="page-description">Share memories to help conversations feel more like them</p>
          </div>
          <button id="bulk-import-btn" data-testid="button-bulk-import" class="btn-secondary">Bulk Import</button>
        </div>
        <div class="page-content">
          <div id="memories-list" data-testid="list-memories">
            <p class="placeholder">Select a persona to view memories</p>
          </div>

          <div class="memory-hint" id="memory-hint" style="display: none;">
            <p><strong>Helpful tip:</strong> Anytime a memory pops into your mind, you can add it here. Every memory you share helps our conversations feel more like them.</p>
          </div>

          <div class="add-memory-form">
            <h3>Add Memory</h3>
            <form id="memory-form">
              <div class="form-group">
                <label for="memory-category">Category *</label>
                <select id="memory-category" data-testid="select-memory-category" required>
                  <option value="">-- Choose category --</option>
                  <option value="humor">Humor</option>
                  <option value="regrets">Regrets</option>
                  <option value="childhood">Childhood</option>
                  <option value="advice">Advice</option>
                  <option value="personality">Personality</option>
                  <option value="misc">Misc</option>
                </select>
              </div>
              <div class="form-group">
                <label for="memory-text">Memory *</label>
                <div class="memory-text-wrapper">
                  <textarea id="memory-text" data-testid="input-memory-text" rows="3" required placeholder="Describe this memory..."></textarea>
                  <button type="button" id="voice-record-btn" data-testid="button-voice-record" class="voice-btn" title="Record voice">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
                      <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                      <line x1="12" y1="19" x2="12" y2="22"></line>
                    </svg>
                  </button>
                </div>
                <div class="voice-status" id="voice-status" style="display: none;"></div>
              </div>
              <div class="form-group">
                <label for="memory-weight">Weight (0.1 - 5.0)</label>
                <input type="number" id="memory-weight" data-testid="input-memory-weight" min="0.1" max="5.0" step="0.1" value="1.0">
              </div>
              <button type="submit" data-testid="button-add-memory">Add Memory</button>
            </form>
          </div>
        </div>
      </section>

      <!-- Personas Page -->
      <section class="page-view" id="page-personas" data-page="personas" style="display: none;">
        <div class="page-header">
          <div class="page-header-content">
            <h2>Manage Personas</h2>
            <p class="page-description">Create and manage the people you'd like to talk to</p>
          </div>
          <button class="btn-settings-mobile" id="btn-settings-mobile" data-testid="button-settings-mobile" aria-label="Settings">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M12 1v6m0 6v6m-9-9h6m6 0h6m-3.343-5.657l-4.243 4.243m0 6l4.243 4.243m-10.606 0l4.243-4.243m0-6L3.343 3.343"></path>
            </svg>
          </button>
        </div>
        <div class="page-content">
          <div class="persona-selector-section">
            <h3>Select Persona</h3>
            <select id="persona-dropdown" data-testid="select-persona">
              <option value="">-- Choose a persona --</option>
            </select>
            <div class="persona-status" id="sidebar-persona-status">
              <p class="status-value" id="sidebar-persona-name">None selected</p>
              <p class="status-completion" id="sidebar-persona-completion">Setup not started</p>
            </div>
          </div>

          <div class="persona-info-section">
            <h3>Current Persona Info</h3>
            <div class="persona-info" id="persona-info">
              <p class="info-item"><strong>Name:</strong> <span id="info-name" data-testid="text-persona-name">-</span></p>
              <p class="info-item"><strong>Relationship:</strong> <span id="info-relationship" data-testid="text-persona-relationship">-</span></p>
              <p class="info-item"><strong>Description:</strong> <span id="info-description" data-testid="text-persona-description">-</span></p>
            </div>
            
            <div class="wizard-section" id="wizard-section" style="display: none;">
              <button class="btn-setup-wizard" id="setup-wizard-btn" data-testid="button-setup-wizard">Setup Wizard</button>
              <p class="wizard-hint">Use the wizard to quickly set up this persona with AI-guided questions</p>
            </div>
          </div>

          <div class="create-persona-section">
            <h3>Create New Persona</h3>
            <form id="persona-form">
              <div class="form-group">
                <label for="persona-name">Name *</label>
                <input type="text" id="persona-name" data-testid="input-persona-name" required>
              </div>
              <div class="form-group">
                <label for="persona-relationship">Relationship</label>
                <input type="text" id="persona-relationship" data-testid="input-persona-relationship" placeholder="e.g., Brother, Mother, Friend">
              </div>
              <div class="form-group">
                <label for="persona-description">Description</label>
                <textarea id="persona-description" data-testid="input-persona-description" rows="3" placeholder="Tell us about this person..."></textarea>
              </div>
              <button type="submit" data-testid="button-save-persona">Save Persona</button>
            </form>
          </div>
        </div>
      </section>

      <!-- Settings Page -->
      <section class="page-view" id="page-settings" data-page="settings" style="display: none;">
        <div class="page-header">
          <button class="btn-back-mobile" id="btn-back-from-settings" data-testid="button-back-from-settings" aria-label="Back to Personas">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
          </button>
          <div class="page-header-content">
            <h2>Persona Settings</h2>
            <p class="page-description">Calibrate communication style and boundaries</p>
          </div>
        </div>
        <div class="page-content">
          <div class="settings-container" id="settings-section">
            <div class="form-group">
              <label for="tone-mode-select">Default Tone Mode</label>
              <select id="tone-mode-select" class="settings-select" data-testid="select-tone-mode">
                <option value="auto">Auto</option>
                <option value="comforting">Comforting</option>
                <option value="honest">Honest</option>
                <option value="playful">Playful</option>
                <option value="balanced">Balanced</option>
              </select>
            </div>

            <div class="slider-group">
              <label for="humor-slider">Humor <span id="humor-value" class="slider-value">3</span></label>
              <input type="range" id="humor-slider" min="0" max="5" step="0.5" value="3" class="calibration-slider" data-testid="slider-humor">
            </div>

            <div class="slider-group">
              <label for="honesty-slider">Honesty <span id="honesty-value" class="slider-value">3</span></label>
              <input type="range" id="honesty-slider" min="0" max="5" step="0.5" value="3" class="calibration-slider" data-testid="slider-honesty">
            </div>

            <div class="slider-group">
              <label for="sentimentality-slider">Sentimentality <span id="sentimentality-value" class="slider-value">3</span></label>
              <input type="range" id="sentimentality-slider" min="0" max="5" step="0.5" value="3" class="calibration-slider" data-testid="slider-sentimentality">
            </div>

            <div class="slider-group">
              <label for="energy-slider">Energy <span id="energy-value" class="slider-value">3</span></label>
              <input type="range" id="energy-slider" min="0" max="5" step="0.5" value="3" class="calibration-slider" data-testid="slider-energy">
            </div>

            <div class="slider-group">
              <label for="advice-slider">Advice-giving <span id="advice-value" class="slider-value">2</span></label>
              <input type="range" id="advice-slider" min="0" max="5" step="0.5" value="2" class="calibration-slider" data-testid="slider-advice">
            </div>

            <div class="boundaries-group">
              <label class="boundary-label">Boundaries</label>
              <div class="checkbox-item">
                <input type="checkbox" id="avoid-regret-spirals" checked data-testid="checkbox-avoid-regret">
                <label for="avoid-regret-spirals">Avoid regret spirals</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="no-paranormal-language" checked data-testid="checkbox-no-paranormal">
                <label for="no-paranormal-language">No paranormal language</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="soften-sensitive-topics" checked data-testid="checkbox-soften-sensitive">
                <label for="soften-sensitive-topics">Soften sensitive topics</label>
              </div>
              <div class="checkbox-item">
                <input type="checkbox" id="prefer-reassurance" checked data-testid="checkbox-prefer-reassurance">
                <label for="prefer-reassurance">Prefer reassurance</label>
              </div>
            </div>

            <button class="btn-save-settings" id="save-settings-btn" data-testid="button-save-settings">Save Settings</button>
            <div class="settings-feedback" id="settings-feedback" style="display: none;"></div>
            
            <div class="boost-section">
              <button class="btn-boost-persona" id="boost-persona-btn" data-testid="button-boost-persona">Improve Persona Accuracy</button>
              <p class="boost-hint">Get AI-powered recommendations to enhance this persona</p>
            </div>

            <div class="snapshots-container" id="snapshots-section">
              <h3>Snapshots</h3>
              <p class="snapshots-description">Save versions of this persona to restore later</p>
              <button class="btn-create-snapshot" id="create-snapshot-btn" data-testid="button-create-snapshot">Create Snapshot</button>
              <div id="snapshots-list" data-testid="list-snapshots">
                <p class="placeholder">No snapshots yet</p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Bulk Import Modal -->
  <div id="bulk-import-modal" class="modal" style="display: none;" data-testid="modal-bulk-import">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Bulk Import Memories</h2>
        <button class="modal-close" id="close-bulk-import" data-testid="button-close-bulk-import">&times;</button>
      </div>
      <div class="modal-body">
        <p class="modal-description">Paste multiple memories below (one per line, or separated by periods or semicolons). AI will automatically categorize and weight each memory.</p>
        <form id="bulk-import-form">
          <div class="form-group">
            <label for="bulk-text">Memories</label>
            <textarea id="bulk-text" data-testid="input-bulk-text" rows="10" required placeholder="He loved fishing at the lake. Always told dad jokes. Gave great advice about work..."></textarea>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="auto-weight-checkbox" data-testid="checkbox-auto-weight" checked>
            <label for="auto-weight-checkbox">Auto-assign categories & weights using AI</label>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn-secondary" id="cancel-bulk-import" data-testid="button-cancel-bulk-import">Cancel</button>
            <button type="submit" data-testid="button-import-memories">Import Memories</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Setup Wizard Modal -->
  <div id="wizard-modal" class="modal wizard-modal" style="display: none;" data-testid="modal-wizard">
    <div class="modal-content wizard-content">
      <div class="modal-header">
        <h2 class="wizard-header-title">Everspeak Would Like to Learn More For a Unique Experience</h2>
        <div class="wizard-header-controls">
          <button class="modal-close" id="close-wizard" data-testid="button-close-wizard">&times;</button>
        </div>
      </div>
      
      <!-- Progress Indicator -->
      <div class="wizard-progress">
        <div class="progress-bar">
          <div class="progress-fill" id="wizard-progress-fill"></div>
        </div>
        <p class="progress-text" id="wizard-progress-text">Getting to know them‚Ä¶ Step <span id="wizard-current-step">1</span> of <span id="wizard-total-steps">11</span></p>
      </div>

      <div class="modal-body">
        <form id="wizard-form">
          <!-- Step 1: Welcome / Step Zero -->
          <div class="wizard-step wizard-step-welcome" id="wizard-step-1" data-step="1">
            <!-- Main welcome screen -->
            <div class="wizard-welcome-main" id="wizard-welcome-main">
              <h3>Welcome to EverSpeak.</h3>
              <p class="step-description">Before we begin, I want to gently explain what this space is for.</p>
              <p class="step-description">EverSpeak was created to help you reconnect with the memory, personality, and presence of someone you've lost ‚Äî not by replacing them, but by honoring the stories and love you shared.</p>
              <p class="step-description">To do that, I'll ask you a few thoughtful questions. Each one helps me understand your loved one more fully ‚Äî their personality, their humor, and the role they played in your life.</p>
              <p class="step-description">You are always in control. You can skip anything that feels too hard, and you can stop at any time. This isn't a test. It's a conversation we'll take at your pace.</p>

              <div class="voice-space-recommendation">
                <div class="voice-space-icon">üéôÔ∏è</div>
                <p class="voice-space-text"><strong>A gentle note:</strong> This experience works best when you can speak your answers aloud. If possible, find a quiet, private space where you feel comfortable speaking openly.</p>
              </div>

              <div class="wizard-welcome-actions">
                <button type="button" class="btn-wizard-primary" id="btn-wizard-ready" data-testid="button-wizard-ready">I'm ready to begin</button>
                <button type="button" class="btn-wizard-continue" id="btn-wizard-continue" data-testid="button-wizard-continue" style="display: none;">Continue where you left off</button>
                <button type="button" class="btn-wizard-secondary" id="btn-wizard-tell-more" data-testid="button-wizard-tell-more">I'm not sure‚Ä¶ tell me more</button>
              </div>
            </div>
            
            <!-- "Tell me more" expanded screen -->
            <div class="wizard-welcome-more" id="wizard-welcome-more" style="display: none;">
              <h3>Of course. This isn't something anyone rushes into.</h3>
              <p class="step-description">EverSpeak will never pretend to actually be your loved one, and it will never claim to know things you didn't share. Instead, it listens closely to the memories you choose to tell and reflects them back with care, respect, and gentleness.</p>
              <p class="step-description">Many people find that simply talking about their loved one ‚Äî telling stories, recalling their voice, remembering the small things ‚Äî can bring comfort or even healing.</p>
              <p class="step-description">You can share as little or as much as you like. Nothing you share will be used for anything other than helping you build that experience.</p>
              
              <div class="wizard-welcome-actions">
                <button type="button" class="btn-wizard-primary" id="btn-wizard-okay-begin" data-testid="button-wizard-okay-begin">Okay, let's begin</button>
                <button type="button" class="btn-wizard-secondary" id="btn-wizard-back" data-testid="button-wizard-back">Back</button>
              </div>
            </div>
          </div>

          <!-- Step 2: User's First Name -->
          <div class="wizard-step" id="wizard-step-2" data-step="2" style="display: none;">
            <p class="step-intro">Before we begin, I'd like to know your name so I can make this conversation feel more personal.</p>
            <p class="step-question">What's your first name?</p>
            <input type="text" id="wizard-user-name" class="wizard-text-input" data-testid="input-wizard-user-name" placeholder="Your first name">
          </div>

          <!-- Step 3: Loved One's First Name -->
          <div class="wizard-step" id="wizard-step-3" data-step="3" style="display: none;">
            <p class="step-acknowledgment" id="step-3-acknowledgment"></p>
            <p class="step-intro">Before we go any further, I want to acknowledge something important: you're here because you lost someone who mattered deeply to you. That takes courage. We'll go through this slowly and gently.</p>
            <p class="step-question">Would you mind sharing their first name with me?</p>

            <!-- Voice Recorder -->
            <div class="voice-recorder" id="voice-recorder-3" data-field="wizard-first-name">
              <p class="voice-guidance">For example: "His name was Jim, but I always called him Jimmy." Feel free to share any nicknames or what you called them.</p>

              <!-- Idle: Mic button -->
              <div class="recorder-idle">
                <button type="button" class="recorder-mic" data-testid="btn-record-3">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                  </svg>
                </button>
                <span class="recorder-hint">Tap to record</span>
              </div>

              <!-- Bar: Recording AND Playback -->
              <div class="recorder-bar" data-mode="recording" style="display: none;">
                <button type="button" class="bar-btn-left">
                  <svg class="icon-stop" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                  <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M8 5v14l11-7z"/></svg>
                  <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <div class="bar-waveform"><div class="waveform-track"><div class="waveform-progress"></div></div></div>
                <span class="bar-time">0:00</span>
                <button type="button" class="bar-btn-right" style="display: none;"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></button>
              </div>

              <button type="button" class="recorder-redo" style="display: none;">Redo</button>
              <audio class="recorder-audio" style="display: none;"></audio>

              <!-- Processing -->
              <div class="recorder-processing" style="display: none;">
                <div class="processing-spinner"></div>
                <span>Processing...</span>
              </div>

              <!-- Complete -->
              <div class="recorder-complete" style="display: none;">
                <p class="recorder-transcription"></p>
                <button type="button" class="recorder-again">Record again</button>
              </div>

              <input type="hidden" id="wizard-first-name" data-testid="input-wizard-first-name">

              <div class="type-fallback">
                <button type="button" class="btn-type-instead">I'd rather type my answer</button>
              </div>

              <div class="text-input-fallback" style="display: none;">
                <input type="text" class="wizard-text-input" data-testid="input-wizard-first-name-text" placeholder="Their first name">
                <button type="button" class="btn-use-voice">Use voice instead</button>
              </div>
            </div>
          </div>

          <!-- Step 4: Relationship -->
          <div class="wizard-step" id="wizard-step-4" data-step="4" style="display: none;">
            <p class="step-acknowledgment" id="step-4-acknowledgment"></p>
            <p class="step-question" id="step-4-question"></p>
            <p class="step-description">I ask because the nature of your bond is central to understanding your loss.</p>

            <!-- Voice Recorder -->
            <div class="voice-recorder" id="voice-recorder-4" data-field="wizard-relationship">
              <p class="voice-guidance">For example: "She was my grandmother, but she was really more like a second mom to me." Share what the relationship meant to you.</p>

              <div class="recorder-idle">
                <button type="button" class="recorder-mic" data-testid="btn-record-4">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                  </svg>
                </button>
                <span class="recorder-hint">Tap to record</span>
              </div>

              <div class="recorder-bar" data-mode="recording" style="display: none;">
                <button type="button" class="bar-btn-left">
                  <svg class="icon-stop" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                  <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M8 5v14l11-7z"/></svg>
                  <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <div class="bar-waveform"><div class="waveform-track"><div class="waveform-progress"></div></div></div>
                <span class="bar-time">0:00</span>
                <button type="button" class="bar-btn-right" style="display: none;"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></button>
              </div>

              <button type="button" class="recorder-redo" style="display: none;">Redo</button>
              <audio class="recorder-audio" style="display: none;"></audio>

              <div class="recorder-processing" style="display: none;">
                <div class="processing-spinner"></div>
                <span>Processing...</span>
              </div>

              <div class="recorder-complete" style="display: none;">
                <p class="recorder-transcription"></p>
                <button type="button" class="recorder-again">Record again</button>
              </div>

              <input type="hidden" id="wizard-relationship" data-testid="input-wizard-relationship">

              <div class="type-fallback">
                <button type="button" class="btn-type-instead">I'd rather type my answer</button>
              </div>

              <div class="text-input-fallback" style="display: none;">
                <input type="text" class="wizard-text-input" data-testid="input-wizard-relationship-text" placeholder="Mother? Uncle? Good Friend?">
                <button type="button" class="btn-use-voice">Use voice instead</button>
              </div>
            </div>
          </div>

          <!-- Step 5: Date of Passing -->
          <div class="wizard-step" id="wizard-step-5" data-step="5" style="display: none;">
            <p class="step-acknowledgment" id="step-5-acknowledgment"></p>
            <p class="step-question" id="step-5-question"></p>
            <p class="step-description">I ask because understanding the timeline of your loss helps me appreciate the context of your grief.</p>

            <!-- Voice Recorder -->
            <div class="voice-recorder" id="voice-recorder-5" data-field="wizard-date-passed">
              <p class="voice-guidance">For example: "It was about three years ago, right before Christmas." However you remember it is perfect.</p>

              <div class="recorder-idle">
                <button type="button" class="recorder-mic" data-testid="btn-record-5">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                  </svg>
                </button>
                <span class="recorder-hint">Tap to record</span>
              </div>

              <div class="recorder-bar" data-mode="recording" style="display: none;">
                <button type="button" class="bar-btn-left">
                  <svg class="icon-stop" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                  <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M8 5v14l11-7z"/></svg>
                  <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <div class="bar-waveform"><div class="waveform-track"><div class="waveform-progress"></div></div></div>
                <span class="bar-time">0:00</span>
                <button type="button" class="bar-btn-right" style="display: none;"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></button>
              </div>

              <button type="button" class="recorder-redo" style="display: none;">Redo</button>
              <audio class="recorder-audio" style="display: none;"></audio>

              <div class="recorder-processing" style="display: none;">
                <div class="processing-spinner"></div>
                <span>Processing...</span>
              </div>

              <div class="recorder-complete" style="display: none;">
                <p class="recorder-transcription"></p>
                <button type="button" class="recorder-again">Record again</button>
              </div>

              <input type="hidden" id="wizard-date-passed" data-testid="input-wizard-date-passed">

              <div class="type-fallback">
                <button type="button" class="btn-type-instead">I'd rather type my answer</button>
              </div>

              <div class="text-input-fallback" style="display: none;">
                <input type="text" class="wizard-text-input" data-testid="input-wizard-date-passed-text" placeholder="A year ago? 2015? Last month? 1995?">
                <button type="button" class="btn-use-voice">Use voice instead</button>
              </div>
            </div>
          </div>

          <!-- Step 6: Circumstances of Passing -->
          <div class="wizard-step" id="wizard-step-6" data-step="6" style="display: none;">
            <p class="step-acknowledgment" id="step-6-acknowledgment"></p>
            <p class="step-question" id="step-6-question"></p>
            <p class="step-description">I ask because the nature of a loss can deeply shape the experience of grief.</p>

            <!-- Voice Recorder -->
            <div class="voice-recorder" id="voice-recorder-6" data-field="wizard-circumstances">
              <p class="voice-guidance">Take your time. For example: "It was sudden‚Äîa heart attack. We didn't get to say goodbye." Share as much or as little as feels right.</p>

              <div class="recorder-idle">
                <button type="button" class="recorder-mic" data-testid="btn-record-6">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                  </svg>
                </button>
                <span class="recorder-hint">Tap to record</span>
              </div>

              <div class="recorder-bar" data-mode="recording" style="display: none;">
                <button type="button" class="bar-btn-left">
                  <svg class="icon-stop" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                  <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M8 5v14l11-7z"/></svg>
                  <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <div class="bar-waveform"><div class="waveform-track"><div class="waveform-progress"></div></div></div>
                <span class="bar-time">0:00</span>
                <button type="button" class="bar-btn-right" style="display: none;"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></button>
              </div>

              <button type="button" class="recorder-redo" style="display: none;">Redo</button>
              <audio class="recorder-audio" style="display: none;"></audio>

              <div class="recorder-processing" style="display: none;">
                <div class="processing-spinner"></div>
                <span>Processing...</span>
              </div>

              <div class="recorder-complete" style="display: none;">
                <p class="recorder-transcription"></p>
                <button type="button" class="recorder-again">Record again</button>
              </div>

              <input type="hidden" id="wizard-circumstances" data-testid="input-wizard-circumstances">

              <div class="type-fallback">
                <button type="button" class="btn-type-instead">I'd rather type my answer</button>
              </div>

              <div class="text-input-fallback" style="display: none;">
                <textarea class="wizard-text-input" data-testid="input-wizard-circumstances-text" rows="4" placeholder="You can share as much or as little as feels right."></textarea>
                <button type="button" class="btn-use-voice">Use voice instead</button>
              </div>
            </div>

            <button type="button" class="btn-skip-step" id="skip-circumstances" data-testid="button-skip-circumstances">I'd rather not say how at this time</button>
            <p class="skip-caption" id="skip-circumstances-caption" style="display: none;">Completely understand. If you ever feel up to it, you can add this information in the settings to help shape <span id="skip-name-placeholder"></span>'s persona.</p>
          </div>

          <!-- Step 7: Relationship Dynamics -->
          <div class="wizard-step" id="wizard-step-7" data-step="7" style="display: none;">
            <p class="step-acknowledgment">Thank you for trusting me with that. It holds a lot of weight. To help me understand more fully, let's move onto the next question. You are doing great, I want you to know.</p>
            <p class="step-question" id="step-7-question"></p>

            <!-- Voice Recorder -->
            <div class="voice-recorder" id="voice-recorder-7" data-field="wizard-relationship-end">
              <p class="voice-guidance">For example: "We talked every Sunday. He always asked about the kids first." Share what your connection was like toward the end.</p>

              <div class="recorder-idle">
                <button type="button" class="recorder-mic" data-testid="btn-record-7">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                  </svg>
                </button>
                <span class="recorder-hint">Tap to record</span>
              </div>

              <div class="recorder-bar" data-mode="recording" style="display: none;">
                <button type="button" class="bar-btn-left">
                  <svg class="icon-stop" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                  <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M8 5v14l11-7z"/></svg>
                  <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <div class="bar-waveform"><div class="waveform-track"><div class="waveform-progress"></div></div></div>
                <span class="bar-time">0:00</span>
                <button type="button" class="bar-btn-right" style="display: none;"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></button>
              </div>

              <button type="button" class="recorder-redo" style="display: none;">Redo</button>
              <audio class="recorder-audio" style="display: none;"></audio>

              <div class="recorder-processing" style="display: none;">
                <div class="processing-spinner"></div>
                <span>Processing...</span>
              </div>

              <div class="recorder-complete" style="display: none;">
                <p class="recorder-transcription"></p>
                <button type="button" class="recorder-again">Record again</button>
              </div>

              <input type="hidden" id="wizard-relationship-end" data-testid="input-wizard-relationship-end">

              <div class="type-fallback">
                <button type="button" class="btn-type-instead">I'd rather type my answer</button>
              </div>

              <div class="text-input-fallback" style="display: none;">
                <textarea class="wizard-text-input" data-testid="input-wizard-relationship-end-text" rows="4" placeholder="We were best friends? We were no longer on speaking terms?"></textarea>
                <button type="button" class="btn-use-voice">Use voice instead</button>
              </div>
            </div>
          </div>

          <!-- Step 8: Humor -->
          <div class="wizard-step" id="wizard-step-8" data-step="8" style="display: none;">
            <p class="step-acknowledgment">Thank you for sharing that. That helps me understand the situation much more clearly.</p>
            <p class="step-question" id="step-8-question"></p>
            <p class="step-description">I ask because remembering someone's spirit‚Äîthe sound of their laugh, what made them light up‚Äîis often a vital part of honoring their memory and navigating the journey of grief.</p>

            <!-- Voice Recorder -->
            <div class="voice-recorder" id="voice-recorder-8" data-field="wizard-humor">
              <p class="voice-guidance">For example: "She had this dry, sarcastic wit. She'd say something under her breath and I'd lose it." What made them laugh? What made YOU laugh together?</p>

              <div class="recorder-idle">
                <button type="button" class="recorder-mic" data-testid="btn-record-8">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                  </svg>
                </button>
                <span class="recorder-hint">Tap to record</span>
              </div>

              <div class="recorder-bar" data-mode="recording" style="display: none;">
                <button type="button" class="bar-btn-left">
                  <svg class="icon-stop" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                  <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M8 5v14l11-7z"/></svg>
                  <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <div class="bar-waveform"><div class="waveform-track"><div class="waveform-progress"></div></div></div>
                <span class="bar-time">0:00</span>
                <button type="button" class="bar-btn-right" style="display: none;"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></button>
              </div>

              <button type="button" class="recorder-redo" style="display: none;">Redo</button>
              <audio class="recorder-audio" style="display: none;"></audio>

              <div class="recorder-processing" style="display: none;">
                <div class="processing-spinner"></div>
                <span>Processing...</span>
              </div>

              <div class="recorder-complete" style="display: none;">
                <p class="recorder-transcription"></p>
                <button type="button" class="recorder-again">Record again</button>
              </div>

              <input type="hidden" id="wizard-humor" data-testid="input-wizard-humor">

              <div class="type-fallback">
                <button type="button" class="btn-type-instead">I'd rather type my answer</button>
              </div>

              <div class="text-input-fallback" style="display: none;">
                <textarea class="wizard-text-input" data-testid="input-wizard-humor-text" rows="4" placeholder="What was their sense of humor like?"></textarea>
                <button type="button" class="btn-use-voice">Use voice instead</button>
              </div>
            </div>
          </div>

          <!-- Step 9: Share a Memory -->
          <div class="wizard-step" id="wizard-step-9" data-step="9" style="display: none;">
            <p class="step-acknowledgment">Thank you for sharing that. It's a beautiful thing to be able to still hear the echo of someone's laughter in your memory.</p>
            <p class="step-question" id="step-9-question"></p>
            <p class="step-description">I ask because these enduring memories often hold the deepest connections to who a person was to us, and giving voice to them can be a way of honoring that bond.</p>

            <!-- Voice Recorder -->
            <div class="voice-recorder" id="voice-recorder-9" data-field="wizard-memories">
              <p class="voice-guidance">For example: "I remember this one fishing trip. We didn't catch anything, but we talked for hours. He told me about when he met mom..." The more detail, the better.</p>

              <div class="recorder-idle">
                <button type="button" class="recorder-mic" data-testid="btn-record-9">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                  </svg>
                </button>
                <span class="recorder-hint">Tap to record</span>
              </div>

              <div class="recorder-bar" data-mode="recording" style="display: none;">
                <button type="button" class="bar-btn-left">
                  <svg class="icon-stop" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                  <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M8 5v14l11-7z"/></svg>
                  <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <div class="bar-waveform"><div class="waveform-track"><div class="waveform-progress"></div></div></div>
                <span class="bar-time">0:00</span>
                <button type="button" class="bar-btn-right" style="display: none;"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></button>
              </div>

              <button type="button" class="recorder-redo" style="display: none;">Redo</button>
              <audio class="recorder-audio" style="display: none;"></audio>

              <div class="recorder-processing" style="display: none;">
                <div class="processing-spinner"></div>
                <span>Processing...</span>
              </div>

              <div class="recorder-complete" style="display: none;">
                <p class="recorder-transcription"></p>
                <button type="button" class="recorder-again">Record again</button>
              </div>

              <input type="hidden" id="wizard-memories" data-testid="input-wizard-memories">

              <div class="type-fallback">
                <button type="button" class="btn-type-instead">I'd rather type my answer</button>
              </div>

              <div class="text-input-fallback" style="display: none;">
                <textarea class="wizard-text-input" data-testid="input-wizard-memories-text" rows="4" placeholder="Share a memory that has stayed with you..."></textarea>
                <button type="button" class="btn-use-voice">Use voice instead</button>
              </div>
            </div>
          </div>

          <!-- Step 10: Things Left Unsaid -->
          <div class="wizard-step" id="wizard-step-10" data-step="10" style="display: none;">
            <p class="step-acknowledgment">Thank you for trusting me with that memory. It's clear that it holds a great deal of meaning for you.</p>
            <p class="step-question" id="step-10-question"></p>
            <p class="step-description">I ask because unspoken words often carry a unique weight in grief. Giving them a space to be acknowledged here can sometimes help lighten that load.</p>

            <!-- Voice Recorder -->
            <div class="voice-recorder" id="voice-recorder-10" data-field="wizard-conversations">
              <p class="voice-guidance">For example: "I wish I'd told him how much I appreciated everything he did for us. I always assumed he knew..." This is a safe space. Say what's been left unsaid.</p>

              <div class="recorder-idle">
                <button type="button" class="recorder-mic" data-testid="btn-record-10">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                    <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                  </svg>
                </button>
                <span class="recorder-hint">Tap to record</span>
              </div>

              <div class="recorder-bar" data-mode="recording" style="display: none;">
                <button type="button" class="bar-btn-left">
                  <svg class="icon-stop" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
                  <svg class="icon-play" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M8 5v14l11-7z"/></svg>
                  <svg class="icon-pause" viewBox="0 0 24 24" fill="currentColor" style="display: none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
                </button>
                <div class="bar-waveform"><div class="waveform-track"><div class="waveform-progress"></div></div></div>
                <span class="bar-time">0:00</span>
                <button type="button" class="bar-btn-right" style="display: none;"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></button>
              </div>

              <button type="button" class="recorder-redo" style="display: none;">Redo</button>
              <audio class="recorder-audio" style="display: none;"></audio>

              <div class="recorder-processing" style="display: none;">
                <div class="processing-spinner"></div>
                <span>Processing...</span>
              </div>

              <div class="recorder-complete" style="display: none;">
                <p class="recorder-transcription"></p>
                <button type="button" class="recorder-again">Record again</button>
              </div>

              <input type="hidden" id="wizard-conversations" data-testid="input-wizard-conversations">

              <div class="type-fallback">
                <button type="button" class="btn-type-instead">I'd rather type my answer</button>
              </div>

              <div class="text-input-fallback" style="display: none;">
                <textarea class="wizard-text-input" data-testid="input-wizard-conversations-text" rows="4" placeholder="Things you wish you could have said or heard..."></textarea>
                <button type="button" class="btn-use-voice">Use voice instead</button>
              </div>
            </div>
          </div>

          <!-- Step 11: Wrapping Up -->
          <div class="wizard-step" id="wizard-step-11" data-step="11" style="display: none;">
            <p class="step-acknowledgment" id="step-11-acknowledgment"></p>
            
            <div class="wizard-transition-summary">
              <p class="transition-text">EverSpeak takes this information and builds your loved one's persona. You are encouraged to always visit the settings and add new memories for a richer experience.</p>
            </div>
            
            <div class="wizard-progress-container" id="wizard-progress-container" style="display: none;">
              <p class="wizard-progress-text">Please wait while we complete the set up...</p>
              <div class="wizard-progress-bar">
                <div class="wizard-progress-fill" id="wizard-progress-fill"></div>
              </div>
            </div>
            
            <button type="button" class="btn-wizard-begin" id="wizard-begin-conversation" data-testid="button-wizard-begin" style="display: none;">
              <span id="wizard-begin-text">I'm ready to have my first conversation with them</span>
            </button>
          </div>

          <!-- Breathing Exercise Screen -->
          <div class="wizard-breathing-screen" id="wizard-breathing-screen" style="display: none;">
            <div class="breathing-container">
              <h3 class="breathing-title">Let's take a moment together...</h3>
              <p class="breathing-instruction" id="breathing-instruction">Breathe in</p>

              <div class="breathing-circle-container">
                <div class="breathing-circle" id="breathing-circle">
                  <div class="breathing-circle-inner"></div>
                </div>
              </div>

              <p class="breathing-subtitle">Just breathe with me</p>

              <button type="button" class="btn-skip-breathing" id="btn-skip-breathing">Skip</button>
            </div>
          </div>

          <!-- AI Acknowledgment Screen -->
          <div class="wizard-acknowledgment-screen" id="wizard-acknowledgment-screen" style="display: none;">
            <div class="acknowledgment-container">
              <div class="acknowledgment-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>
              </div>
              <p class="acknowledgment-text" id="acknowledgment-text"></p>
            </div>
          </div>

          <!-- Navigation Buttons -->
          <div class="wizard-navigation">
            <button type="button" class="btn-secondary" id="wizard-prev" data-testid="button-wizard-prev" style="display: none;">Previous</button>
            <div class="nav-spacer"></div>
            <button type="button" id="wizard-next" data-testid="button-wizard-next">Next</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Boost Modal -->
  <div id="boost-modal" class="modal boost-modal" style="display: none;" data-testid="modal-boost">
    <div class="modal-content boost-content">
      <div class="modal-header">
        <h2>Persona Accuracy Recommendations</h2>
        <button class="modal-close" id="close-boost" data-testid="button-close-boost">&times;</button>
      </div>
      
      <div class="modal-body">
        <div id="boost-loading" class="boost-loading">
          <p>Analyzing persona... This may take a moment.</p>
          <div class="loading-spinner"></div>
        </div>
        
        <div id="boost-results" style="display: none;">
          <!-- Missing Categories -->
          <div class="boost-section">
            <h3>Missing Categories</h3>
            <div id="missing-categories-list"></div>
          </div>

          <!-- Suggested Memories -->
          <div class="boost-section">
            <h3>Suggested Memories</h3>
            <div id="suggested-memories-list"></div>
          </div>

          <!-- Tone Suggestions -->
          <div class="boost-section">
            <h3>Tone Calibration Suggestions</h3>
            <div id="tone-suggestions-container"></div>
            <button class="btn-apply-tone" id="apply-tone-btn" data-testid="button-apply-tone" style="display: none;">Apply Tone Suggestions</button>
          </div>

          <!-- Boundary Flags -->
          <div class="boost-section">
            <h3>Boundary Flags</h3>
            <div id="boundary-flags-list"></div>
          </div>

          <div class="boost-actions">
            <button class="btn-secondary" id="refresh-boost-btn" data-testid="button-refresh-boost">Refresh Recommendations</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Tab Bar (Mobile Navigation) -->
  <nav class="bottom-tab-bar" id="bottom-tab-bar" data-testid="bottom-tab-bar">
    <button class="tab-item" data-page="home" data-testid="tab-home" aria-label="Home">
      <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        <polyline points="9 22 9 12 15 12 15 22"></polyline>
      </svg>
      <span class="tab-label">Home</span>
    </button>

    <button class="tab-item" data-page="conversation" data-testid="tab-conversation" aria-label="Conversation">
      <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
      </svg>
      <span class="tab-label">Chat</span>
    </button>

    <button class="tab-item" data-page="journal" data-testid="tab-journal" aria-label="Journal">
      <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
      </svg>
      <span class="tab-label">Journal</span>
    </button>

    <button class="tab-item" data-page="memories" data-testid="tab-memories" aria-label="Memories">
      <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2a10 10 0 1 0 10 10H12V2z"></path>
        <path d="M12 2v10h10a10 10 0 0 0-10-10z"></path>
      </svg>
      <span class="tab-label">Memories</span>
    </button>

    <button class="tab-item" data-page="personas" data-testid="tab-personas" aria-label="Personas">
      <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
        <circle cx="12" cy="7" r="4"></circle>
      </svg>
      <span class="tab-label">Personas</span>
    </button>
  </nav>

  <script src="/wizardEngine.js?v=20241229-1"></script>
<script src="/app.js?v=20241229-3"></script>
</body>
</html>

